@{
    ViewData["Title"] = "User Home";
}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - AutoMart</title>
    <link rel="stylesheet" href="~/css/styles.css" />
</head>
<body>

    <!-- 🔹 NAVBAR -->
    <nav>
        <div class="logo-container">
            <img src="~/images/logo.png" alt="AutoMart Logo" />
        </div>
        <ul class="nav-links">
            <li><a asp-controller="Home" asp-action="UserHome">User Home</a></li>
			<li><a asp-controller="Home" asp-action="Viewcars">View Cars</a></li>

        </ul>
    </nav>

    <!-- 🔹 HERO -->
    <section class="hero">
        <h1>Discover Your Next Car</h1>
        <p>Search from a wide range of vehicles</p>
        <div class="search-bar">
            <input type="text" id="search-input" placeholder="Search by brand, model, or fuel..." />
        </div>
    </section>

    <!-- 🚘 BRAND FILTER SECTION -->
    <section class="brand-section">
        <h2 style="text-align:center; margin-bottom: 1rem;">All Brands</h2>
        <div class="brand-grid" id="brandGrid">
            <!-- Brand logos dynamically rendered -->
        </div>
    </section>

    <!-- 🔎 Search Results -->
    <section class="car-listing">
        <div id="car-list"></div>
    </section>

    <!-- 🚗 FEATURED CARS -->
    <section class="featured-section">
        <h2>Featured Cars</h2>
        <div class="featured-scroll" id="featuredCars"></div>
    </section>

    <!-- 🚙 SUV/SEDAN SECTION -->
    <section class="featured-section">
        <h2>SUVs & Sedans</h2>
        <div class="featured-scroll" id="carCategories"></div>
    </section>

    <!-- 🔻 FOOTER -->
    <footer>
        <p>&copy; 2025 AutoDeals | All rights reserved</p>
    </footer>

    <!-- 🔸 Scripts -->
    <script>
        let carsData = [];

        fetch("/CarListing/GetAllCars")
            .then(res => res.json())
            .then(data => {
                carsData = data;
                renderFeatured(data.slice(0, 4));
                renderCategories(data.filter(c => c.carType.includes("SUV") || c.carType.includes("Sedan")));
                renderBrands(data);
                renderCars(data); // initial load
            })
            .catch(error => {
                console.error("Failed to load car data:", error);
                document.getElementById("car-list").innerHTML = "<p>Error loading car data.</p>";
            });

        function renderFeatured(cars) {
            document.getElementById("featuredCars").innerHTML = cars.map(carCard).join("");
        }

        function renderCategories(cars) {
            document.getElementById("carCategories").innerHTML = cars.slice(0, 6).map(carCard).join("");
        }

        function renderCars(cars) {
            document.getElementById("car-list").innerHTML = cars.map(carCard).join("");
        }

        function carCard(car) {
            return `
            <div class="featured-card">
                <img src="${car.photos[0]}" alt="${car.brand} ${car.model}" />
                <div class="content">
                    <h4>${car.brand} ${car.model}</h4>
                    <p><strong>Price:</strong> $${car.price.toLocaleString()}</p>
                    <p><strong>Fuel:</strong> ${car.fuelType}</p>
                </div>
            </div>`;
        }

        function renderBrands(data) {
            const brands = [...new Set(data.map(car => car.brand))].slice(0, 12);
            const brandHTML = brands.map(brand => `
                <div class="brand-item" onclick="filterByBrand('${brand}')">
                    <img src="/images/brands/${brand.toLowerCase().replace(/\s/g, '')}.png" alt="${brand}" />
                    <p>${brand}</p>
                </div>
            `).join("");
            document.getElementById("brandGrid").innerHTML = brandHTML;
        }

        function filterByBrand(brand) {
            const filtered = carsData.filter(car => car.brand.toLowerCase() === brand.toLowerCase());
            renderCars(filtered);
            document.getElementById("search-input").value = ""; // clear search
        }

        // Search functionality
        document.getElementById("search-input").addEventListener("input", function () {
            const query = this.value.toLowerCase();
            const filtered = carsData.filter(car =>
                car.brand.toLowerCase().includes(query) ||
                car.model.toLowerCase().includes(query) ||
                car.fuelType.toLowerCase().includes(query)
            );
            renderCars(filtered);
        });
    </script>

</body>
</html>
